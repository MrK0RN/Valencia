<!-- Cases Section (EN) -->
<div class="section">
    <div class="text-content" style="align-items: center;">
        <div class="section-title" style="color: #60724F">Cases & Reviews</div>
        <div class="section-subtitle">
            Real client stories: remote search, visa support, full legal closing, and post-move adaptation.
        </div>
    </div>
    <div class="cases-container">
        <div class="cases-images">
            <div class="cases-carousel">
                <div class="carousel-container">
                    <img class="carousel-slide active" src="assets/img/wp14994047-valencia-4k-wallpapers.png" alt="Case">
                    <img class="carousel-slide" src="assets/img/wp14994051-valencia-4k-wallpapers.png" alt="Case">
                    <img class="carousel-slide" src="assets/img/wp14994063-valencia-4k-wallpapers.png" alt="Case">
                    <img class="carousel-slide" src="assets/img/backiee-114132-landscape.png" alt="Case">
                    <img class="carousel-slide" src="assets/img/backiee-184611-landscape.png" alt="Case">
                    <img class="carousel-slide" src="assets/img/backiee-231876-landscape.png" alt="Case">
                </div>
                <button class="carousel-btn carousel-prev" onclick="changeSlide(-1)">‹</button>
                <button class="carousel-btn carousel-next" onclick="changeSlide(1)">›</button>
                <div class="carousel-dots">
                    <span class="dot active" onclick="currentSlide(1)"></span>
                    <span class="dot" onclick="currentSlide(2)"></span>
                    <span class="dot" onclick="currentSlide(3)"></span>
                    <span class="dot" onclick="currentSlide(4)"></span>
                    <span class="dot" onclick="currentSlide(5)"></span>
                    <span class="dot" onclick="currentSlide(6)"></span>
                </div>
            </div>
        </div>
        <div class="cases-text">
            <div class="cases-title">Petrov Family — Ruzafa apartment</div>
            <div class="cases-details">
                <div class="table">
                    <div class="table-row">
                        <div class="table-label">Check-in date</div>
                        <div class="table-value">12 March 2024</div>
                    </div>
                    <div class="table-row">
                        <div class="table-label">Relocation duration</div>
                        <div class="table-value">2 weeks from first call to signing</div>
                    </div>
                    <div class="table-row">
                        <div class="table-label">City district</div>
                        <div class="table-value">Ruzafa, Valencia — near Turia park</div>
                    </div>
                    <div class="table-row">
                        <div class="table-label">Number of rooms</div>
                        <div class="table-value">3 bedrooms plus living room</div>
                    </div>
                    <div class="table-row">
                        <div class="table-label">Apartment area</div>
                        <div class="table-value">96 m² with terrace and parking</div>
                    </div>
                </div>
                <div class="feedback" id="feedback">
                    <div class="feedback-header">
                        <div class="feedback-avatar"></div>
                        <div class="feedback-name">Name</div>
                    </div>
                    <div class="feedback-text" id="feedback-text">As a foreigner dreaming of moving to Valencia, I felt from the first call that they understood my needs and worries. This was more than selling square meters—they helped me build life from scratch, stayed available 24/7, guided negotiations and paperwork, and after the purchase connected me with trusted local contractors.</div>
                    <div class="read-more" id="read-more-btn" onclick="toggleFeedback()">
                        <div class="read-more-text" id="read-more-text">Read more</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
(function() {
    let currentSlideIndex = 0;
    let slides, dots;
    let carouselInterval;

    function initCarousel() {
        const carousel = document.querySelector('.cases-carousel');
        if (!carousel) return;
        
        slides = carousel.querySelectorAll('.carousel-slide');
        dots = carousel.querySelectorAll('.dot');
        
        if (slides.length === 0) return;
        
        showSlide(0);
        
        // Auto-play carousel
        if (carouselInterval) clearInterval(carouselInterval);
        carouselInterval = setInterval(() => {
            changeSlide(1);
        }, 5000);
    }

    function showSlide(n) {
        if (!slides || slides.length === 0) return;
        
        if (n >= slides.length) currentSlideIndex = 0;
        if (n < 0) currentSlideIndex = slides.length - 1;
        
        slides.forEach(slide => slide.classList.remove('active'));
        if (dots) dots.forEach(dot => dot.classList.remove('active'));
        
        slides[currentSlideIndex].classList.add('active');
        if (dots && dots[currentSlideIndex]) dots[currentSlideIndex].classList.add('active');
    }

    window.changeSlide = function(n) {
        currentSlideIndex += n;
        showSlide(currentSlideIndex);
        // Reset auto-play timer
        if (carouselInterval) clearInterval(carouselInterval);
        carouselInterval = setInterval(() => {
            changeSlide(1);
        }, 5000);
    };

    window.currentSlide = function(n) {
        currentSlideIndex = n - 1;
        showSlide(currentSlideIndex);
        // Reset auto-play timer
        if (carouselInterval) clearInterval(carouselInterval);
        carouselInterval = setInterval(() => {
            changeSlide(1);
        }, 5000);
    };

    // Initialize when DOM is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initCarousel);
    } else {
        initCarousel();
    }
})();

// Feedback toggle functionality
let feedbackTimer = null;

function toggleFeedback() {
    const feedback = document.getElementById('feedback');
    const feedbackText = document.getElementById('feedback-text');
    const readMoreText = document.getElementById('read-more-text');
    
    if (!feedback || !feedbackText || !readMoreText) return;
    
    const isExpanded = feedback.classList.contains('expanded');
    
    if (isExpanded) {
        // Collapse
        feedback.classList.remove('expanded');
        feedbackText.classList.remove('expanded');
        readMoreText.textContent = 'Read more';
        
        // Clear timer if exists
        if (feedbackTimer) {
            clearTimeout(feedbackTimer);
            feedbackTimer = null;
        }
    } else {
        // Expand
        feedback.classList.add('expanded');
        feedbackText.classList.add('expanded');
        readMoreText.textContent = 'Hide';
        
        // Clear any existing timer
        if (feedbackTimer) {
            clearTimeout(feedbackTimer);
        }
        
        // Set timer to close after 30 seconds
        feedbackTimer = setTimeout(() => {
            feedback.classList.remove('expanded');
            feedbackText.classList.remove('expanded');
            readMoreText.textContent = 'Read more';
            feedbackTimer = null;
        }, 30000);
    }
}
</script>


